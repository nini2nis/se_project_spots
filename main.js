!function(){"use strict";var e="",t=e+"d3610e9c6dce3cb370d8.svg",r=e+"d38272e02bb4f1ab1c37.svg",o=e+"40608da7369d39bc1077.svg";function n(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Save";e.textContent=t?r:o}const a={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"},s=(e,t,r)=>{const o=e.querySelector(`.${t.id}-error`);t.classList.remove(r.inputErrorClass),o.classList.remove(r.errorClass),o.textContent=""},c=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?i(t,r):(t.classList.remove(r.inactiveButtonClass),t.disabled=!1)},i=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.disabled=!0},l=e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{t.addEventListener("submit",(e=>{e.preventDefault()})),((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);c(r,o,t),r.forEach((n=>{n.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?s(e,t,r):((e,t,r,o)=>{const n=e.querySelector(`.${t.id}-error`);t.classList.add(o.inputErrorClass),n.classList.add(o.errorClass),n.textContent=r})(e,t,t.validationMessage,r)})(e,n,t),c(r,o,t)}))}))})(t,e)}))};l(a),document.getElementById("header__logo").src=t,document.getElementById("profile__edit-icon").src=r,document.getElementById("profile__post-icon").src=o;const d=document.getElementById("profile__avatar"),u=document.querySelector("#avatar-modal"),m=document.forms["edit-avatar"],_=document.querySelector(".profile__avatar-btn"),h=u.querySelector("#avatar-link"),v=document.querySelector(".profile__edit-button"),f=document.querySelector("#edit-modal"),y=document.forms["edit-profile"],p=f.querySelector("#profile-name"),b=f.querySelector("#profile-description"),S=document.querySelector(".profile__name"),E=document.querySelector(".profile__description"),g=document.querySelector(".profile__post-button"),q=document.querySelector("#post-modal"),L=document.forms["new-post-form"],k=q.querySelector("#card-link"),C=q.querySelector("#card-name"),$=q.querySelector(".modal__submit-button"),j=document.querySelector(".cards__list"),U=document.querySelectorAll(".modal"),x=document.querySelector("#card-template"),I=document.querySelector("#modal-preview"),P=I.querySelector(".modal__image-name"),A=I.querySelector(".modal__image"),D=document.querySelector("#modal-delete"),B=D.querySelector(".modal__form"),w=document.querySelector(".modal__cancel-button"),T=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"cb408f20-cef0-4ee4-a289-c2194b9dd6d5","Content-Type":"application/json"}});let N,O;function J(e){console.log(e);const t=x.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__text"),o=t.querySelector(".card__image"),n=t.querySelector(".card__heart-button"),a=t.querySelector(".card__trash-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked&&n.classList.toggle("card__heart-button_liked"),n.addEventListener("click",(t=>{!function(e,t){const r=e.target.classList.contains("card__heart-button_liked");T.changeLikeStatus(t,r).then((()=>{e.target.classList.toggle("card__heart-button_liked")})).catch((e=>{console.error(e)}))}(t,e._id)})),a.addEventListener("click",(()=>function(e,t){N=e,O=t._id,H(D)}(t,e))),o.addEventListener("click",(()=>function(e){H(I),P.textContent=e.name,A.src=e.link,A.alt=e.name}(e))),t}function H(e){e.classList.add("modal_opened"),document.addEventListener("keydown",M),document.addEventListener("click",F)}function z(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",M),document.removeEventListener("click",F)}function M(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&z(e)}}function F(e){if(e.target===w){const e=document.querySelector(".modal_opened");e&&z(e)}}T.getAppInfo().then((e=>{let[t,r]=e;S.textContent=t.name,E.textContent=t.about,d.src=t.avatar,r.forEach((e=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";const r=J(e);j[t](r)}(e,"append")}))})).catch((e=>{console.error(e)})),v.addEventListener("click",(()=>{var e,t;p.value=S.textContent,b.value=E.textContent,e=f,t=a,[p,b].forEach((r=>{s(e,r,t)})),H(f)})),_.addEventListener("click",(()=>{H(u)})),g.addEventListener("click",(()=>{H(q)})),U.forEach((e=>{e.addEventListener("mousedown",(t=>{t.target.classList.contains("modal_opened")&&z(e),t.target.classList.contains("modal__close-button")&&z(e)}))})),y.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;n(t,!0),T.editUserInfo({name:p.value,about:b.value}).then((e=>{S.textContent=e.name,E.textContent=e.about,z(f)})).catch((e=>{console.error(e)})).finally((()=>{n(t,!1)}))})),L.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;n(t,!0),T.addNewCard({name:C.value,link:k.value}).then((t=>{const r=J(t);j.prepend(r),e.target.reset(),i($,a),z(q)})).catch((e=>{console.error(e)})).finally((()=>{n(t,!1)}))})),B.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;n(t,!0,"Deleting...","Delete"),T.removeCard(O).then((()=>{N.remove(),z(D)})).catch((e=>{console.error(e)})).finally(n(t,!1,"Deleting...","Delete"))})),m.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;n(t,!0),T.editAvatar({avatar:h.value}).then((t=>{d.src=t.avatar,z(u),e.target.reset()})).catch((e=>{console.error(e)})).finally((()=>{n(t,!1)}))})),l(a)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVEsS0FDUGxLLEVBQWNnSyxHQUFjLEVBQU0sR0FFeEMsSUFrS0E1SCxFQUFpQjNCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9IZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoXHJcbiAgYnV0dG9uLFxyXG4gIGlzTG9hZGluZyxcclxuICBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIsXHJcbiAgZGVmYXVsdFRleHQgPSBcIlNhdmVcIlxyXG4pIHtcclxuICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gZGVmYXVsdFRleHQ7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgZm9ybUlucHV0LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1FcnJvciA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2Zvcm1JbnB1dC5pZH0tZXJyb3JgKTtcclxuICBmb3JtSW5wdXQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBmb3JtRXJyb3IuY2xhc3NMaXN0LmFkZChjb25maWcuZXJyb3JDbGFzcyk7XHJcbiAgZm9ybUVycm9yLnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGZvcm1JbnB1dCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUVycm9yID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7Zm9ybUlucHV0LmlkfS1lcnJvcmApO1xyXG4gIGZvcm1JbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGZvcm1FcnJvci5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5lcnJvckNsYXNzKTtcclxuICBmb3JtRXJyb3IudGV4dENvbnRlbnQgPSBcIlwiO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBmb3JtSW5wdXQsIGNvbmZpZykgPT4ge1xyXG4gIGlmICghZm9ybUlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgZm9ybUlucHV0LCBmb3JtSW5wdXQudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBmb3JtSW5wdXQsIGNvbmZpZyk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxufTtcclxuXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcclxuICApO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChmb3JtSW5wdXQpID0+IHtcclxuICAgIGZvcm1JbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGZvcm1JbnB1dCwgY29uZmlnKTtcclxuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG5cclxuZXhwb3J0IHsgc2V0dGluZ3MsIHJlc2V0VmFsaWRhdGlvbiwgZGlzYWJsZUJ1dHRvbiwgZW5hYmxlVmFsaWRhdGlvbiB9O1xyXG4iLCIvKiAgIEhUTUwgJiBDU1MgTU9EVUxFIElNUE9SVFMgICAgICovXHJcblxyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuaW1wb3J0IGxvZ29TcmMgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xyXG5jb25zdCBsb2dvSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhlYWRlcl9fbG9nb1wiKTtcclxubG9nb0ltYWdlLnNyYyA9IGxvZ29TcmM7XHJcblxyXG5pbXBvcnQgcGVuU3JjIGZyb20gXCIuLi9pbWFnZXMvaWNvbl9wZW4uc3ZnXCI7XHJcbmNvbnN0IHBlbkltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlX19lZGl0LWljb25cIik7XHJcbnBlbkltYWdlLnNyYyA9IHBlblNyYztcclxuXHJcbmltcG9ydCBwbHVzU3JjIGZyb20gXCIuLi9pbWFnZXMvaWNvbl9wbHVzLnN2Z1wiO1xyXG5jb25zdCBwbHVzSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVfX3Bvc3QtaWNvblwiKTtcclxucGx1c0ltYWdlLnNyYyA9IHBsdXNTcmM7XHJcblxyXG4vKiAgICBKUyBNT0RVTEUgSU1QT1JUUyAgICAgICAgICAqL1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuaW1wb3J0IHsgc2V0QnV0dG9uVGV4dCB9IGZyb20gXCIuLi91dGlscy9IZWxwZXJzLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgc2V0dGluZ3MsXHJcbiAgcmVzZXRWYWxpZGF0aW9uLFxyXG4gIGRpc2FibGVCdXR0b24sXHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcblxyXG4vKiAgQVZBVEFSIFNFTEVDVE9SUyAgICAgKi9cclxuY29uc3QgYXZhdGFySW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVfX2F2YXRhclwiKTtcclxuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1hdmF0YXJcIl07XHJcbmNvbnN0IGF2YXRhckVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idG5cIik7XHJcbmNvbnN0IGF2YXRhckxpbmtJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWxpbmtcIik7XHJcblxyXG4vKiAgIFBST0ZJTEUgU0VMRUNUT1JTICAgICovXHJcbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlXCJdO1xyXG5jb25zdCBwcm9maWxlTmFtZUlucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5cclxuLyogICBDQVJEIFNFTEVDVE9SUyAgICAgKi9cclxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcG9zdC1idXR0b25cIik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9zdC1tb2RhbFwiKTtcclxuY29uc3QgY2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm5ldy1wb3N0LWZvcm1cIl07XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWxpbmtcIik7XHJcbmNvbnN0IGNhcmROYW1lSW5wdXQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLW5hbWVcIik7XHJcbmNvbnN0IGNhcmRTdWJtaXRCdXR0b24gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbi8qICAgTU9EQUwgJiBURU1QTEFURSBTRUxFQ1RPUlMgICAgICovXHJcbmNvbnN0IHBvcHVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuXHJcbi8qICAgSU1BR0UgTU9EQUwgU0VMRUNUT1JTICAgKi9cclxuY29uc3QgbW9kYWxQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1wcmV2aWV3XCIpO1xyXG5jb25zdCBtb2RhbEltYWdlTmFtZSA9IG1vZGFsUHJldmlldy5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1uYW1lXCIpO1xyXG5jb25zdCBtb2RhbEltYWdlID0gbW9kYWxQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG5cclxuLyogICAgREVMRVRFIE1PREFMIFNFTEVDVE9SUyAgICAqL1xyXG5jb25zdCBtb2RhbERlbGV0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtZGVsZXRlXCIpO1xyXG5jb25zdCBkZWxldGVGb3JtID0gbW9kYWxEZWxldGUucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgY2FuY2VsTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYW5jZWwtYnV0dG9uXCIpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiY2I0MDhmMjAtY2VmMC00ZWU0LWEyODktYzIxOTRiOWRkNmQ1XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW3VzZXJJbmZvLCBjYXJkc10pID0+IHtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmFib3V0O1xyXG4gICAgYXZhdGFySW1hZ2Uuc3JjID0gdXNlckluZm8uYXZhdGFyO1xyXG4gICAgY2FyZHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKGl0ZW0sIFwiYXBwZW5kXCIpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcclxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgdHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSxcclxuICAgICAgYWJvdXQ6IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRBdmF0YXIoe1xyXG4gICAgICBhdmF0YXI6IGF2YXRhckxpbmtJbnB1dC52YWx1ZSxcclxuICAgIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBhdmF0YXJJbWFnZS5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICAgICAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XHJcbiAgICAgIGV2dC50YXJnZXQucmVzZXQoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoeyBuYW1lOiBjYXJkTmFtZUlucHV0LnZhbHVlLCBsaW5rOiBjYXJkTGlua0lucHV0LnZhbHVlIH0pXHJcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSk7XHJcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcclxuICAgICAgY2xvc2VNb2RhbChhZGRDYXJkTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCBmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxubGV0IHNlbGVjdGVkQ2FyZDtcclxubGV0IHNlbGVjdGVkQ2FyZElkO1xyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gIGNvbnN0IGNhcmROYW1lID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190ZXh0XCIpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgaGVhcnRCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2hlYXJ0LWJ1dHRvblwiKTtcclxuICBjb25zdCB0cmFzaEJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpO1xyXG5cclxuICBjYXJkTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcblxyXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcclxuICAgIGhlYXJ0QnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19oZWFydC1idXR0b25fbGlrZWRcIik7XHJcbiAgfVxyXG4gIGhlYXJ0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICBoYW5kbGVMaWtlKGV2dCwgZGF0YS5faWQpO1xyXG4gIH0pO1xyXG4gIHRyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSlcclxuICApO1xyXG4gIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gaGFuZGxlSW1hZ2VDbGljayhkYXRhKSk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGlkKSB7XHJcbiAgY29uc3QgaXNMaWtlZCA9IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9faGVhcnQtYnV0dG9uX2xpa2VkXCIpO1xyXG4gIGFwaVxyXG4gICAgLmNoYW5nZUxpa2VTdGF0dXMoaWQsIGlzTGlrZWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2hlYXJ0LWJ1dHRvbl9saWtlZFwiKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhkYXRhKSB7XHJcbiAgb3Blbk1vZGFsKG1vZGFsUHJldmlldyk7XHJcbiAgbW9kYWxJbWFnZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgbW9kYWxJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgbW9kYWxJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpIHtcclxuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcclxuICBzZWxlY3RlZENhcmRJZCA9IGRhdGEuX2lkO1xyXG4gIG9wZW5Nb2RhbChtb2RhbERlbGV0ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdXR0b24gPSBldnQuc3VibWl0dGVyO1xyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCB0cnVlLCBcIkRlbGV0aW5nLi4uXCIsIFwiRGVsZXRlXCIpO1xyXG4gIGFwaVxyXG4gICAgLnJlbW92ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcclxuICAgICAgY2xvc2VNb2RhbChtb2RhbERlbGV0ZSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCBmYWxzZSwgXCJEZWxldGluZy4uLlwiLCBcIkRlbGV0ZVwiKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VPbkVzYyk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsb3NlT25DYW5jZWxCdG4pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU9uRXNjKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VPbkNhbmNlbEJ0bik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlT25Fc2MoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IGFjdGl2ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICBpZiAoYWN0aXZlTW9kYWwpIGNsb3NlTW9kYWwoYWN0aXZlTW9kYWwpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VPbkNhbmNlbEJ0bihldnQpIHtcclxuICBpZiAoZXZ0LnRhcmdldCA9PT0gY2FuY2VsTW9kYWxCdXR0b24pIHtcclxuICAgIGNvbnN0IGFjdGl2ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICBpZiAoYWN0aXZlTW9kYWwpIGNsb3NlTW9kYWwoYWN0aXZlTW9kYWwpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChpdGVtLCBtZXRob2QgPSBcInByZXBlbmRcIikge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XHJcbiAgY2FyZHNMaXN0W21ldGhvZF0oY2FyZEVsZW1lbnQpO1xyXG59XHJcblxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICByZXNldFZhbGlkYXRpb24oXHJcbiAgICBlZGl0TW9kYWwsXHJcbiAgICBbcHJvZmlsZU5hbWVJbnB1dCwgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXRdLFxyXG4gICAgc2V0dGluZ3NcclxuICApO1xyXG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xyXG59KTtcclxuXHJcbmF2YXRhckVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuXHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoYWRkQ2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5wb3B1cHMuZm9yRWFjaCgocG9wdXApID0+IHtcclxuICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xyXG4gICAgICBjbG9zZU1vZGFsKHBvcHVwKTtcclxuICAgIH1cclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIikpIHtcclxuICAgICAgY2xvc2VNb2RhbChwb3B1cCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XHJcbmNhcmRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQ2FyZEZvcm1TdWJtaXQpO1xyXG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcclxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQpO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIGluIHRoZSBib2R5IGFzIGEgSlNPTiBzdHJpbmcuXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0QXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIGluIHRoZSBib2R5IGFzIGEgSlNPTiBzdHJpbmcuXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2hhbmdlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcblxyXG4vL1Rva2VuOiBjYjQwOGYyMC1jZWYwLTRlZTQtYTI4OS1jMjE5NGI5ZGQ2ZDVcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXRCdXR0b25UZXh0IiwiYnV0dG9uIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJkZWZhdWx0VGV4dCIsInRleHRDb250ZW50Iiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJmb3JtSW5wdXQiLCJjb25maWciLCJmb3JtRXJyb3IiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwiZW5hYmxlVmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJnZXRFbGVtZW50QnlJZCIsInNyYyIsImxvZ29TcmMiLCJwZW5TcmMiLCJwbHVzU3JjIiwiYXZhdGFySW1hZ2UiLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJmb3JtcyIsImF2YXRhckVkaXRCdG4iLCJhdmF0YXJMaW5rSW5wdXQiLCJlZGl0UHJvZmlsZUJ1dHRvbiIsImVkaXRNb2RhbCIsInByb2ZpbGVGb3JtIiwicHJvZmlsZU5hbWVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJhZGRDYXJkQnV0dG9uIiwiYWRkQ2FyZE1vZGFsIiwiY2FyZEZvcm0iLCJjYXJkTGlua0lucHV0IiwiY2FyZE5hbWVJbnB1dCIsImNhcmRTdWJtaXRCdXR0b24iLCJjYXJkc0xpc3QiLCJwb3B1cHMiLCJjYXJkVGVtcGxhdGUiLCJtb2RhbFByZXZpZXciLCJtb2RhbEltYWdlTmFtZSIsIm1vZGFsSW1hZ2UiLCJtb2RhbERlbGV0ZSIsImRlbGV0ZUZvcm0iLCJjYW5jZWxNb2RhbEJ1dHRvbiIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRBdmF0YXIiLCJfcmVmMyIsImF2YXRhciIsImFkZE5ld0NhcmQiLCJfcmVmNCIsImxpbmsiLCJyZW1vdmVDYXJkIiwiY2hhbmdlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWUiLCJjYXJkSW1hZ2UiLCJoZWFydEJ1dHRvbiIsInRyYXNoQnV0dG9uIiwiYWx0IiwidG9nZ2xlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJjYXRjaCIsImVyciIsImVycm9yIiwiaGFuZGxlTGlrZSIsIl9pZCIsIm9wZW5Nb2RhbCIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVJbWFnZUNsaWNrIiwibW9kYWwiLCJjbG9zZU9uRXNjIiwiY2xvc2VPbkNhbmNlbEJ0biIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwiYWN0aXZlTW9kYWwiLCJ1c2VySW5mbyIsImNhcmRzIiwiaXRlbSIsInJlbmRlckNhcmQiLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZSIsInBvcHVwIiwic3VibWl0QnV0dG9uIiwic3VibWl0dGVyIiwiZmluYWxseSIsImNhcmREYXRhIiwicHJlcGVuZCIsInJlc2V0Il0sInNvdXJjZVJvb3QiOiIifQ==